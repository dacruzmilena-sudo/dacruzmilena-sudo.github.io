<!DOCTYPE html>
<html>
  <head>
    <title>Transit Restaurants Map</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      #map {
        height: 100vh;
        width: 100vw;
        margin: 0;
        padding: 0;
      }

      body {
        margin: 0;
        padding: 0;
      }
    </style>

    <!-- Load Google Maps JS with Places library -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places"></script>

    <!-- Load external stations data -->
    <script src="stations.js"></script>
    
    <script>
      function initMap() {
        const map = new google.maps.Map(document.getElementById("map"), {
          center: { lat: 25.7743, lng: -80.1937 },
          zoom: 13,
        });

        // Make sure `stations` is loaded from stations.js
        if (typeof stations === 'undefined') {
          alert("Station data not loaded.");
          return;
        }

        stations.forEach((station) => {
          const position = { lat: station.lat, lng: station.lng };

          // Draw radius circle
          new google.maps.Circle({
            map,
            center: position,
            radius: 800,
            strokeColor: "#007BFF",
            strokeOpacity: 0.5,
            fillColor: "#007BFF",
            fillOpacity: 0.1,
          });

          // Add station marker
          new google.maps.Marker({
            position,
            map,
            title: station.name,
            icon: {
              path: google.maps.SymbolPath.CIRCLE,
              scale: 6,
              fillColor: "#FFFFFF",
              fillOpacity: 1,
              strokeWeight: 0,
            },
          });

          // Nearby restaurant search
          const service = new google.maps.places.PlacesService(map);
          service.nearbySearch(
            {
              location: position,
              radius: 800,
              type: "restaurant",
            },
            (results, status) => {
              if (status === google.maps.places.PlacesServiceStatus.OK) {
                results.forEach((place) => {
                  new google.maps.Marker({
                    position: place.geometry.location,
                    map,
                    title: place.name,
                  });
                });
              }
            }
          );
        });
      }
    </script>
  </head>

  <body onload="initMap()">
    <div id="map"></div>
  </body>
</html>
